(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-91f57740"],{"16d9":function(e,t,s){"use strict";var a=s("cd41"),o=s.n(a);o.a},"632b":function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.getPost?s("v-container",{staticClass:"mt-3",attrs:{flexbox:"",center:""}},[s("v-layout",{attrs:{row:"",wrap:""}},[s("v-flex",{attrs:{xs12:""}},[s("v-card",{attrs:{hover:""}},[s("v-card-title",[s("h1",[e._v(e._s(e.getPost.title))]),e.user?s("v-btn",{attrs:{large:"",icon:""},on:{click:e.handleToggleLike}},[s("v-icon",{attrs:{large:"",color:e.checkIfPostLiked(e.getPost._id)?"red":"grey"}},[e._v("favorite")])],1):e._e(),s("h3",{staticClass:"ml-3 font-weight-thin"},[e._v(e._s(e.getPost.likes)+" LIKES")]),s("v-spacer"),s("v-icon",{attrs:{color:"info",large:""},on:{click:e.goToPreviousPage}},[e._v("arrow_back")])],1),s("v-tooltip",{attrs:{right:""}},[s("span",[e._v("Click to enlarge image")]),s("v-img",{attrs:{slot:"activator",src:e.getPost.imageUrl,id:"post__image"},on:{click:e.toggleImageDialog},slot:"activator"})],1),s("v-dialog",{model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[s("v-card",[s("v-img",{attrs:{src:e.getPost.imageUrl,height:"80vh"}})],1)],1),s("v-card-text",[e._l(e.getPost.categories,function(t,a){return s("span",{key:a},[s("v-chip",{staticClass:"mb-3",attrs:{color:"accent","text-color":"white"}},[e._v(e._s(t))])],1)}),s("h3",[e._v(e._s(e.getPost.description))])],2)],1)],1)],1),s("div",{staticClass:"mt-3"},[e.user?s("v-layout",{staticClass:"mb-3"},[s("v-flex",{attrs:{xs12:""}},[s("v-form",{ref:"form",attrs:{"lazy-validation":""},on:{submit:function(t){return t.preventDefault(),e.handleAddPostMessage(t)}},model:{value:e.isFormValid,callback:function(t){e.isFormValid=t},expression:"isFormValid"}},[s("v-layout",{attrs:{row:""}},[s("v-flex",{attrs:{xs12:""}},[s("v-text-field",{attrs:{rules:e.messageRules,clearable:"","append-outer-icon":e.messageBody&&"send",label:"Add Message",type:"text","prepend-icon":"email",required:""},on:{"click:append-outer":e.handleAddPostMessage},model:{value:e.messageBody,callback:function(t){e.messageBody=t},expression:"messageBody"}})],1)],1)],1)],1)],1):e._e(),s("v-layout",{attrs:{row:"",wrap:""}},[s("v-flex",{attrs:{xs12:""}},[s("v-list",{attrs:{subheader:"","two-line":""}},[s("v-subheader",[e._v("Messages ("+e._s(e.getPost.messages.length)+")")]),e._l(e.getPost.messages,function(t){return[s("v-divider",{key:t._id}),s("v-list-tile",{key:t.title,attrs:{avatar:"",inset:""}},[s("v-list-tile-avatar",[s("img",{attrs:{src:t.messageUser.avatar}})]),s("v-list-tile-content",[s("v-list-tile-title",[e._v("\n                  "+e._s(t.messageBody)+"\n                ")]),s("v-list-tile-sub-title",[e._v("\n                  "+e._s(t.messageUser.username)+"\n                  "),s("span",{staticClass:"grey--text text--lighten-1 hidden-xs-only"},[e._v(e._s(e.getTimeFromNow(t.messageDate)))])])],1),s("v-list-tile-action",{staticClass:"hidden-xs-only"},[s("v-icon",{attrs:{color:e.checkIfOwnMessage(t)?"accent":"grey"}},[e._v("chat_bubble")])],1)],1)]})],2)],1)],1)],1)],1):e._e()},o=[],i=(s("c5f6"),s("be94")),r=s("17fc"),n=s.n(r),l=s("2f62"),d=s("39ff"),c={name:"Post",props:["postId"],data:function(){return{postLiked:!1,dialog:!1,messageBody:"",isFormValid:!0,messageRules:[function(e){return!!e||"Message is required"},function(e){return e.length<75||"Message must be less than 75 characters"}]}},apollo:{getPost:{query:d["e"],variables:function(){return{postId:this.postId}}}},computed:Object(i["a"])({},Object(l["b"])(["user","userFavorites"])),methods:{getTimeFromNow:function(e){return n()(Number(e)).fromNow()},checkIfPostLiked:function(e){return this.userFavorites&&this.userFavorites.some(function(t){return t._id===e})?(this.postLiked=!0,!0):(this.postLiked=!1,!1)},handleToggleLike:function(){this.postLiked?this.handleUnlikePost():this.handleLikePost()},handleLikePost:function(){var e=this,t={postId:this.postId,username:this.user.username};this.$apollo.mutate({mutation:d["i"],variables:t,update:function(t,s){s.data.likePost;var a=t.readQuery({query:d["e"],variables:{postId:e.postId}});a.getPost.likes+=1,t.writeQuery({query:d["e"],variables:{postId:e.postId},data:a})}}).then(function(t){var s=t.data,a=Object(i["a"])({},e.user,{favorites:s.likePost.favorites});e.$store.commit("setUser",a)}).catch(function(e){return console.error(e)})},handleUnlikePost:function(){var e=this,t={postId:this.postId,username:this.user.username};this.$apollo.mutate({mutation:d["m"],variables:t,update:function(t,s){s.data.unlikePost;var a=t.readQuery({query:d["e"],variables:{postId:e.postId}});a.getPost.likes-=1,t.writeQuery({query:d["e"],variables:{postId:e.postId},data:a})}}).then(function(t){var s=t.data,a=Object(i["a"])({},e.user,{favorites:s.unlikePost.favorites});e.$store.commit("setUser",a)}).catch(function(e){return console.error(e)})},handleAddPostMessage:function(){var e=this;if(this.$refs.form.validate()){var t={messageBody:this.messageBody,userId:this.user._id,postId:this.postId};this.$apollo.mutate({mutation:d["b"],variables:t,update:function(t,s){var a=s.data.addPostMessage,o=t.readQuery({query:d["e"],variables:{postId:e.postId}});o.getPost.messages.unshift(a),t.writeQuery({query:d["e"],variables:{postId:e.postId},data:o})}}).then(function(t){var s=t.data;e.$refs.form.reset(),console.log(s.addPostMessage)}).catch(function(e){return console.error(e)})}},goToPreviousPage:function(){this.$router.go(-1)},toggleImageDialog:function(){window.innerWidth>500&&(this.dialog=!this.dialog)},checkIfOwnMessage:function(e){return this.user&&this.user._id===e.messageUser._id}}},u=c,v=(s("16d9"),s("2877")),g=Object(v["a"])(u,a,o,!1,null,"63f9d78e",null);g.options.__file="Post.vue";t["default"]=g.exports},cd41:function(e,t,s){}}]);
//# sourceMappingURL=chunk-91f57740.f478b257.js.map